<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Data Visualization</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #f0f0f0;
				margin: 0px;
				overflow: hidden;
			}
		</style>

	</head>

	<body>



		<script src="three/build/three.js"></script>
		<script src="three/examples/js/libs/stats.min.js"></script>
		<script src="three/examples/js/controls/TrackballControls.js"></script>
		<script src="three/examples/js/libs/dat.gui.min.js"></script>


		<script>
		var container, stats, plane;
var camera, scene, raycaster, renderer;
var mouse = new THREE.Vector2(),
  INTERSECTED;
var radius = 100,
  theta = 0;
init();
animate();
createPanel();

function init() {
  container = document.createElement("div");
  document.body.appendChild(container);
  var info = document.createElement("div");
  info.style.position = "absolute";
  info.style.top = "10px";
  info.style.width = "100%";
  info.style.textAlign = "center";
  container.appendChild(info);
  camera = new THREE.PerspectiveCamera(
    70,
    window.innerWidth / window.innerHeight,
    1,
    10000
  );
  camera.position.z = 500;
  camera.position.y = 500;
  camera.position.x = 500;

  controls = new THREE.TrackballControls(camera);
  controls.rotateSpeed = 1.0;
  controls.zoomSpeed = 1.2;
  controls.panSpeed = 0.8;
  controls.noZoom = false;
  controls.noPan = false;
  controls.staticMoving = true;
  controls.dynamicDampingFactor = 0.3;

  scene = new THREE.Scene();
  scene.background = new THREE.Color(0x000000);
  var light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(1, 1, 1).normalize();
  scene.add(light);

  var geometry = new THREE.SphereGeometry(15, 20, 20);
  for (var i = 0; i < 200; i++) {
    var object = new THREE.Mesh(
      geometry,
      new THREE.MeshLambertMaterial({
        color: Math.random() * 0xffffff,
        transparent: true,
        blending: THREE.AdditiveBlending
      })
    );
    object.position.x = Math.random() * window.innerWidth;
    object.position.y = Math.random() * window.innerHeight;
    object.position.z = Math.random() * 800 - 400;
    scene.add(object);
  }

  var material = new THREE.MeshLambertMaterial({
    map: THREE.ImageUtils.loadTexture("img/sample.png"),
    transparent: true
  });

  plane = new THREE.Mesh(new THREE.PlaneGeometry(150, 150), material);

  plane.visible = false;

  scene.add(plane);

  raycaster = new THREE.Raycaster();
  renderer = new THREE.WebGLRenderer();
  renderer.setPixelRatio(window.devicePixelRatio);
  renderer.setSize(window.innerWidth, window.innerHeight);
  container.appendChild(renderer.domElement);
  stats = new Stats();
  container.appendChild(stats.dom);
  document.addEventListener("mousemove", onDocumentMouseMove, false);
  //
  window.addEventListener("resize", onWindowResize, false);
}

function onWindowResize() {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
}

function onDocumentMouseMove(event) {
  event.preventDefault();
  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
}

function animate() {
  requestAnimationFrame(animate);
  render();
  stats.update();
}

function createPanel() {
  var panel = new dat.GUI({ width: 310 });
  var folder1 = panel.addFolder("Metadata");
  var folder2 = panel.addFolder("Picture");
  settings = {
    "Flowers Color": "Red",
    "Number of Flowers": "3",
    "deactivate all": true,
    "activate all": true
  };
  folder1.add(settings, "Flowers Color");
  folder1.add(settings, "Number of Flowers");
  folder2.add(settings, "deactivate all");
  folder2.add(settings, "activate all");

  folder1.open();
  folder2.open();
}

function render() {
  controls.update();

  plane.position.x = camera.position.x - 100;
  plane.position.y = camera.position.y - 100;
  plane.position.z = camera.position.z;
  plane.rotation.x = camera.rotation.x;
  plane.rotation.y = camera.rotation.y;
  plane.rotation.z = camera.rotation.z;
  // find intersections
  raycaster.setFromCamera(mouse, camera);
  var intersects = raycaster.intersectObjects(scene.children);
  if (intersects.length > 0) {
    if (INTERSECTED != intersects[0].object) {
      if (INTERSECTED)
        INTERSECTED.material.emissive.setHex(INTERSECTED.currentHex);
      INTERSECTED = intersects[0].object;
      console.log(
        "INTERSECTED: " + JSON.stringify(intersects[0].object, 4, null)
      );

      INTERSECTED.currentHex = INTERSECTED.material.emissive.getHex();
      INTERSECTED.material.emissive.setHex(0xff0000);
      plane.visible = true;
    }
  } else {
    if (INTERSECTED)
      INTERSECTED.material.emissive.setHex(INTERSECTED.currentHex);
    INTERSECTED = null;
    plane.visible = false;
  }
  renderer.render(scene, camera);
}
</script>
	</body>
</html>
